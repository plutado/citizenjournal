/*
 * jQuery MegaMenu v1.1
 * http://megamenu.megadrupal.com/
 *
 * Copyright 2013 MegaDrupal
 */
 
(function(e){e(window).resize(function(){e(".mdmegamenu").each(function(){var t=e(this),n=t.outerWidth(true);var r=t.width();if(t.hasClass("md-vertical")){if(t.hasClass("md-vertical-rtl")){var i=e("> ul",t).width();var s=e(window).width()-(e("> ul",t).offset().left+e("> ul",t).outerWidth());r=e(window).width()-i-s-20;if(r>960)r=960-i;e("div.mm-customwidth",t).each(function(){var t=parseInt(e(this).data("width"));if(r<t){e(this).addClass("mm-fullwidth")}else{e(this).width(t);e(this).removeClass("mm-fullwidth")}});if(i>(e(window).width()-s-20)/2){e(".mm-container",t).each(function(){var n=e(this).parent();e(this).css({top:n.height(),left:0});if(e(this).hasClass("mm-fullwidth"))e(this).width(t.width())})}else{e("div.mm-fullwidth",t).width(r)}}else{var i=e("> ul",t).width();var o=e("> ul",t).offset().left;r=e(window).width()-i-o-20;if(r>960)r=960-i;e("div.mm-customwidth",t).each(function(){var t=parseInt(e(this).data("width"));if(r<t){e(this).addClass("mm-fullwidth")}else{e(this).width(t);e(this).removeClass("mm-fullwidth")}});if(i>(e(window).width()-o-20)/2){e(".mm-container",t).each(function(){var n=e(this).parent();e(this).css({top:n.height(),left:0});if(e(this).hasClass("mm-fullwidth"))e(this).width(t.width())})}else{e("div.mm-fullwidth",t).width(r)}}}else{if(t.hasClass("mm-fixed-bottom")){_tmpheight=t.outerHeight()-parseInt(t.css("borderTopWidth"))-parseInt(t.css("borderBottomWidth"));e("> ul > li",t).each(function(){e("> .mm-container",e(this)).css("bottom",_tmpheight)})}else{e("> ul > li",t).each(function(){e("> .mm-container",e(this)).css("top",e(this).height()+e(this).position().top)})}e("div.mm-customwidth",t).each(function(){var r=parseInt(e(this).data("width"));e(this).width(r);e(this).removeClass("mm-fullwidth");var i=e(this).parent("li").position(),s=i.left,o=e(this).width(),u=s+o;if(t.hasClass("mm-fixed-bottom")||t.hasClass("mm-fixed-top")){n=n*2}if(u>n){mainSubLeft=n-o;if(e.browser.msie){if(parseInt(e.browser.version,10)==7||parseInt(e.browser.version,10)==8||parseInt(e.browser.version,10)==9)mainSubLeft=n-o+5}e(this).css("left",mainSubLeft)}else{e(this).css("left",s)}});e(".mm-dropdown",t).each(function(){e(this).children(".mm-container").css("left",e(this).position().left)})}e("div.mm-sub",t).each(function(){var t=e(this).children(".background-color").not(".mmg_12");e(t).each(function(){var t=e(this),n=0,r=t.parents(".mm-container");r.show();n=t.parent().height();if(n>0){t.height(n)}r.hide()})})})});e.fn.megadrupalMenu=function(t){function n(){s(this)}function r(){o(this)}function i(t){e("li",t).removeClass("mm-hover");e(".mm-container",t).hide()}function s(t){var n=e("> .mm-container",t);e(t).parents(".mdmegamenu").find(".mm-container").not(e(t).parents(".mm-container")).hide();e(t).addClass("mm-hover");if(n.length>0&&n.is(":hidden")==false)return;if(n.is(":hidden")){switch(u.effects.effectTypeOpen){case"slide":n.stop(true,true).delay(u.timeBeforeOpening).slideDown(u.effects.effectSpeedOpen,u.effects.effectOpen);break;case"fade":n.stop(true,true).delay(u.timeBeforeOpening).fadeIn(u.effects.effectSpeedOpen,u.effects.effectOpen);break;default:n.stop(true,true).delay(u.timeBeforeOpening).show()}}}function o(t){var n=e("> .mm-container",t);if(n.length>0&&n.is(":hidden")==false){switch(u.effects.effectTypeClose){case"slide":n.stop(true,true).delay(u.timeBeforeClosing).slideUp(u.effects.effectSpeedClose,u.effects.effectClose,function(){e(t).removeClass("mm-hover")});break;case"fade":n.stop(true,true).delay(u.timeBeforeClosing).fadeOut(u.effects.effectSpeedClose,u.effects.effectClose,function(){e(t).removeClass("mm-hover")});break;default:n.stop(true,true).delay(u.timeBeforeClosing).hide();e(t).removeClass("mm-hover")}}else{e(t).removeClass("mm-hover")}}var u=e.extend({effects:{effectSpeedOpen:300,effectSpeedClose:200,effectTypeOpen:"slide",effectTypeClose:"slide",effectOpen:"linear",effectClose:"linear"},timeBeforeOpening:100,timeBeforeClosing:200,trigger:"hover-intent",arrow:false,vertical:false,verticalDirection:"ltr",subAlign:"middle"},t);var a=navigator.userAgent.toLowerCase();var f=a.match(/(iphone|ipod|ipad|android|"windows phone")/);return this.each(function(){var t=e(this),a=t.parent(),l=e("li.mm-parent",t);if(a.hasClass("mm-fixed-bottom")||a.hasClass("mm-fixed-top")){e(".mm-toggle",a).click(function(){e(this).toggleClass("mm-toggle-show");a.toggleClass("mm-toggle-hide");e("> ul",a).slideToggle();return false})}l.each(function(){var t=e(this);if(u.arrow){e("> a",t).addClass("with-arrow").append('<span class="mm-arrow"></span>')}if(u.vertical){if(u.subAlign=="middle"){var n=t.position(),r=n.top,i=t.height(),s=e("> .mm-container",this),o=s.height(),a=o/2-i/2;if(r>a)s.css("top",-a);else{s.css("top",-r)}}}});if(u.trigger==="hover"){l.hover(n,r)}else if(u.trigger==="click"){e("body").mouseup(function(n){if(!e(n.target).parents(".mm-hover").length){i(t)}});e("> a",l).click(function(t){var n=e(this).parent();if(!n.hasClass("mm-hover")){s(n);t.preventDefault()}})}else{var c={sensitivity:2,interval:100,over:n,timeout:400,out:r};l.hoverIntent(c)}if(f){var h="&darr;";if(u.vertical)h="&rarr;";e('<span class="mm-close">&times;</span>').appendTo(e("> li.mm-parent > a",t)).hide().click(function(t){t.preventDefault();"open"==e(this).attr("data-mega-status")?(o(e(this).parents("li.mm-parent")[0]),e(this).html(h).attr("data-mega-status","closed")):(s(e(this).parents("li.mm-parent")[0]),e(this).html("&times;").attr("data-mega-status","open"));return false});e("> li.mm-parent",t).hover(function(t){t.preventDefault();e(this).find(".mm-close").html("&times;").attr("data-mega-status","open").show();e(this).find(".mm-arrow").hide()},function(t){e(this).find(".mm-close").hide();e(this).find(".mm-arrow").show()})}e(window).resize()})}})(jQuery)